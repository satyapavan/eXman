const CC_LL_II_EE_NN_TT_II_DD='505396211486-7rr7ipgf9l86ai9q2vdaum7mnpsb49ih',AA_PP_II_KK_EE_YY='AIzaSyA7ILQmN8Z2c4bIxLw-UQcKAqVLw3RIoWc',SS_HH_EE_EE_TT_II_DD='1DueNTkz7YAAWurv--t0hTmeEOtFxJOUUqPUEHCSZz24',DISCOVERY_DOCS=['https://sheets.googleapis.com/$discovery/rest?version=v4','https://people.googleapis.com/$discovery/rest?version=v1'],SCOPES='https://www.googleapis.com/auth/spreadsheets.readonly profile';google.charts.load('current',{packages:['corechart']});var signinButton=document.getElementById('signin_button'),signoutButton=document.getElementById('signout_button');function handleClientLoad(){gapi.load('client:auth2',initClient)}function initClient(){gapi.client.init({apiKey:AA_PP_II_KK_EE_YY,clientId:CC_LL_II_EE_NN_TT_II_DD,discoveryDocs:DISCOVERY_DOCS,scope:SCOPES}).then(function(){gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus),updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get()),signinButton.onclick=handleAuthClick,signoutButton.onclick=handleSignoutClick},function(a){appendPre(JSON.stringify(a,null,2))})}function paintUserInformation(){gapi.client.people.people.get({resourceName:'people/me','requestMask.includeField':'person.names'}).then(function(a){appendPre('Hello, '+a.result.names[0].givenName)},function(a){console.log('Error: '+a.result.error.message)})}function updateSigninStatus(a){a?(signinButton.style.display='none',signoutButton.style.display='block',paintUserInformation(),drawTxTypeChart()):(signinButton.style.display='block',signoutButton.style.display='none')}function handleAuthClick(){gapi.auth2.getAuthInstance().signIn()}function handleSignoutClick(){gapi.auth2.getAuthInstance().signOut()}function appendPre(a){var b=document.getElementById('content'),c=document.createTextNode(a+'\n');b.appendChild(c)}function drawTxTypeChart(){gapi.client.sheets.spreadsheets.values.get({spreadsheetId:SS_HH_EE_EE_TT_II_DD,range:'2018-12!B2:D'}).then(function(a){var b=new Map([]),c=a.result;if(0<c.values.length){for(i=0;i<c.values.length;i++){var d=c.values[i];appendPre(d[0]+', '+d[2]);var e=parseInt(d[0].replace(',','')),f=d[2];if(b.has(f)){var g=b.get(f);b.set(f,g+e)}else b.set(f,e)}var h=new google.visualization.DataTable;h.addColumn('string','Tx Type'),h.addColumn('number','Expense'),b.forEach(function(k,l){console.log(l,b.get(l)),h.addRow([l,b.get(l)])});var j=new google.visualization.PieChart(document.getElementById('tx_type_pie_chart_div'));j.draw(h,{height:400})}else appendPre('No data found.')},function(a){appendPre('Error: '+a.result.error.message)})}
