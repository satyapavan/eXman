const CC_LL_II_EE_NN_TT_II_DD='505396211486-7rr7ipgf9l86ai9q2vdaum7mnpsb49ih',AA_PP_II_KK_EE_YY='AIzaSyA7ILQmN8Z2c4bIxLw-UQcKAqVLw3RIoWc',SS_HH_EE_EE_TT_II_DD='1DueNTkz7YAAWurv--t0hTmeEOtFxJOUUqPUEHCSZz24',DISCOVERY_DOCS=['https://sheets.googleapis.com/$discovery/rest?version=v4','https://people.googleapis.com/$discovery/rest?version=v1'],SCOPES='https://www.googleapis.com/auth/spreadsheets.readonly profile';google.charts.load('current',{packages:['corechart','table']});var signinButton=document.getElementById('signin_button'),signoutButton=document.getElementById('signout_button');function handleClientLoad(){gapi.load('client:auth2',initClient)}function initClient(){gapi.client.init({apiKey:AA_PP_II_KK_EE_YY,clientId:CC_LL_II_EE_NN_TT_II_DD,discoveryDocs:DISCOVERY_DOCS,scope:SCOPES}).then(function(){gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus),updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get()),signinButton.onclick=handleAuthClick,signoutButton.onclick=handleSignoutClick},function(a){appendPre(JSON.stringify(a,null,2))})}function paintUserInformation(){gapi.client.people.people.get({resourceName:'people/me','requestMask.includeField':'person.names'}).then(function(a){document.getElementById('signInName').innerHTML=a.result.names[0].displayName},function(a){console.log('Error: '+a.result.error.message)})}function surveyScreenDimensions(){var a=0;a=window.innerWidth>window.innerHeight?window.innerHeight:window.innerWidth,a=75*a/100,console.log('window.innerWidth['+window.innerWidth+'] :: window.innerHeight['+window.innerHeight+'] :: dimen['+a+']'),document.getElementById('tx_type_pie_chart_div').style.width=a+'px',document.getElementById('tx_type_pie_chart_div').style.height=a+'px'}function updateSigninStatus(a){a?(signinButton.style.display='none',signoutButton.style.display='block',paintUserInformation(),surveyScreenDimensions(),drawTxTypeChart()):(signinButton.style.display='block',signoutButton.style.display='none')}function handleAuthClick(){gapi.auth2.getAuthInstance().signIn()}function handleSignoutClick(){gapi.auth2.getAuthInstance().signOut()}function drawTxTypeChart(){gapi.client.sheets.spreadsheets.values.get({spreadsheetId:SS_HH_EE_EE_TT_II_DD,range:'2018-12!A2:E'}).then(function(a){var b=new Map([]),c=new google.visualization.DataTable;c.addColumn('string','Date'),c.addColumn('number','Amount'),c.addColumn('string','Vendor'),c.addColumn('string','Tx Type'),c.addColumn('string','Category');var d=a.result;if(0<d.values.length){for(i=0;i<d.values.length;i++){var e=d.values[i],f=parseInt(e[1].replace(',','')),g=e[3];if(c.addRow([e[0],f,e[2],e[3],e[4]]),b.has(g)){var h=b.get(g);b.set(g,h+f)}else b.set(g,f)}var j=new google.visualization.DataTable;j.addColumn('string','Tx Type'),j.addColumn('number','Expense');var k=0;b.forEach(function(o,p){console.log(p,b.get(p)),j.addRow([p,b.get(p)]),k+=+b.get(p)}),document.getElementById('btn_total_exp').innerHTML='Total Rs. '+k;var l=new google.visualization.PieChart(document.getElementById('tx_type_pie_chart_div'));l.draw(j,{chartArea:{width:'100%',height:'80%'},pieHole:0.4,legend:{position:'bottom',alignment:'center'}});var m=new google.visualization.Table(document.getElementById('expense_details'));m.draw(c,{showRowNumber:!0,width:'90%',height:'100%'})}else appendPre('No data found.')},function(a){appendPre('Error: '+a.result.error.message)})}
